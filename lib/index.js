"use strict";function isSupportPassive(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",null,t)}catch(e){}return e}function $(e){return"string"==typeof e?document.querySelector(e):e}function setStyle(e,t,n){var i="number"==typeof n?n+"px":n;if(e.style[t]===i)return!1;e.style[t]=i}function assert(e,t){if(!e)throw new Error(t)}var NOOP=function(){return null};function addEvents(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:NOOP,i=arguments[3];t.forEach(function(t){return e.addEventListener(t,n,i)})}var MOBILE_EVENTS=["touchstart","touchmove","touchend","touchcancel"];function getClientXY(e){if(-1===MOBILE_EVENTS.indexOf(e.type))return{clientX:e.clientX,clientY:e.clientY};var t=e.targetTouches[0]||e.touches[0];return{clientX:t.clientX,clientY:t.clientY}}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var passiveOptions=!!isSupportPassive()&&{passive:!0,capture:!1},Movable=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,e),_initialiseProps.call(this);var n=t.handler,i=void 0===n?".handler":n,o=t.container,s=void 0===o?".container":o,a=t.boundable,r=void 0!==a&&a,l=t.fixed,u=void 0!==l&&l;this.$handler=$(i),this.$container=$(s)||this.$handler,assert(this.$handler,i+" element should be mounted first."),assert(this.$container,s+" element should be mounted first.");var c=this.$container.getBoundingClientRect(),d=c.x,h=c.y,v=c.width,f=c.height;this.state={fixed:u,boundable:r,movable:!1,originX:d,originY:h,width:v,height:f,innerWidth:window.innerWidth,innerHeight:window.innerHeight,currentX:0,currentY:0,deltaX:0,deltaY:0,mouseDeltaX:0,mouseDeltaY:0},this.on()}return _createClass(e,[{key:"styledMembers",value:function(){setStyle(this.$handler,"cursor","move")}},{key:"on",value:function(){this.styledMembers(),addEvents(this.$handler,["mousedown","touchstart"],this.onMouseDown,passiveOptions),addEvents(document,["mouseup","touchend","touchcancel"],this.onMouseUp,passiveOptions),addEvents(document,["mousemove","touchmove"],this.onMouseMove,passiveOptions)}}]),e}();Movable.version="0.0.9";var _initialiseProps=function(){var e=this;this.onMouseDown=function(t){var n=getClientXY(t),i=n.clientX,o=n.clientY;e.state.currentX=i,e.state.currentY=o,e.state.movable=!0},this.onMouseUp=function(){e.state.movable&&(e.state.movable=!1,e.state.deltaX+=e.state.mouseDeltaX,e.state.deltaY+=e.state.mouseDeltaY)},this.onMouseMove=function(t){if(!e.state.movable)return!1;var n=getClientXY(t),i=n.clientX,o=n.clientY,s=i-e.state.currentX,a=o-e.state.currentY;e.state.mouseDeltaX=s,e.state.mouseDeltaY=a;var r=e.state.deltaX+s,l=e.state.deltaY+a;if(e.state.boundable){var u=e.state,c=u.originX,d=u.originY,h=u.width,v=u.height,f=u.innerWidth,p=u.innerHeight;c+r<0?r=-c:f<c+h+r&&(r=f-(c+h)),d+l<0?l=-d:p<d+v+l&&(l=p-(d+v))}setStyle(e.$container,"transform","translate3d("+r+"px, "+l+"px, 0px)")}};module.exports=Movable;
