"use strict";function isSupportPassive(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,e)}catch(t){}return t}function $(t){return"string"==typeof t?document.querySelector(t):t}function setStyle(t,e,n){var o="number"==typeof n?n+"px":n;if(t.style[e]===o)return!1;t.style[e]=o}function assert(t,e){if(!t)throw new Error(e)}var NOOP=function(){return null};function addEvent(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:NOOP;e.forEach(function(e){return t.addEventListener(e,n)})}var MOBILE_EVENTS=["touchstart","touchmove","touchend","touchcancel"];function getClientXY(t){if(-1===MOBILE_EVENTS.indexOf(t.type))return{clientX:t.clientX,clientY:t.clientY};var e=t.targetTouches[0]||t.touches[0];return{clientX:e.clientX,clientY:e.clientY}}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var passiveOptions=!!isSupportPassive()&&{passive:!0,capture:!1},Movable=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t),this.onMouseDown=function(t){var n=e.$container.getBoundingClientRect(),o=n.top,i=n.left,s=n.width,a=n.height,r=getClientXY(t),c=r.clientX,u=r.clientY;e.state.top=o,e.state.left=i,e.state.width=s,e.state.height=a,e.state.maxLeft=window.innerWidth-s,e.state.maxTop=window.innerHeight-a,e.state.currentX=c,e.state.currentY=u,e.state.movable=!0,setStyle(e.$container,"width",s),setStyle(e.$container,"height",a)},this.onMouseUp=function(){e.state.movable&&(e.state.movable=!1)},this.onMouseMove=function(t){if(!e.state.movable)return!1;var n=getClientXY(t),o=n.clientX,i=n.clientY,s=o-e.state.currentX,a=i-e.state.currentY,r=e.state.left+s,c=e.state.top+a;e.state.boundable&&(r<0?r=0:r>e.state.maxLeft&&(r=e.state.maxLeft),c<0?c=0:c>e.state.maxTop&&(c=e.state.maxTop)),setStyle(e.$container,"top",c),setStyle(e.$container,"left",r)};var o=n.handler,i=void 0===o?".handler":o,s=n.container,a=void 0===s?".container":s,r=n.boundable,c=void 0!==r&&r,u=n.fixed,l=void 0!==u&&u;this.$handler=$(i),this.$container=$(a)||this.$handler,assert(this.$handler,i+" element should be mounted first."),assert(this.$container,a+" element should be mounted first."),this.state={fixed:l,boundable:c,movable:!1,currentX:0,currentY:0,top:0,left:0,maxLeft:0,maxTop:0},this.on()}return _createClass(t,[{key:"styledMembers",value:function(){setStyle(this.$container,"position",this.state.fixed?"fixed":"absolute"),setStyle(this.$handler,"cursor","move"),setStyle(this.$container,"box-sizing","border-box")}},{key:"on",value:function(){this.styledMembers(),addEvent(this.$handler,["mousedown","touchstart"],this.onMouseDown,passiveOptions),addEvent(document,["mouseup","touchend","touchcancel"],this.onMouseUp,passiveOptions),addEvent(document,["mousemove","touchmove"],this.onMouseMove,passiveOptions)}}]),t}();module.exports=Movable;
