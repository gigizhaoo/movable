function isSupportPassive(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,e)}catch(t){}return t}function $(t){return"string"==typeof t?document.querySelector(t):t}function setStyle(t,e,n){var a="number"==typeof n?n+"px":n;if(t.style[e]===a)return!1;t.style[e]=a}function setStyles(t,e){Object.keys(e).forEach(function(n){setStyle(t,n,e[n])})}function assert(t,e){if(!t)throw new Error(e)}var NOOP=function(){return null};function addEvents(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:NOOP,a=arguments[3];e.forEach(function(e){return t.addEventListener(e,n,a)})}var MOBILE_EVENTS=["touchstart","touchmove","touchend","touchcancel"];function getClientXY(t){if(-1===MOBILE_EVENTS.indexOf(t.type))return{clientX:t.clientX,clientY:t.clientY};var e=t.targetTouches[0]||t.touches[0];return{clientX:e.clientX,clientY:e.clientY}}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var passiveOptions=!!isSupportPassive()&&{passive:!0,capture:!1},Movable=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t),_initialiseProps.call(this);var n=e.boundable,a=void 0!==n&&n,i=e.fixed,s=void 0!==i&&i,o=e.handler||".handler",r=e.container;this.$handler=$(o),this.$container=r&&$(r)||this.$handler,assert(this.$handler,o+" element should be mounted first."),assert(this.$container,r+" element should be mounted first.");var l=this.$container.getBoundingClientRect(),u=l.x,d=l.y,c=l.width,h=l.height;this.state={fixed:s,boundable:a,movable:!1,boundaried:!1,originX:u,originY:d,width:c,height:h,innerWidth:window.innerWidth,innerHeight:window.innerHeight,currentX:0,currentY:0,deltaX:0,deltaY:0,mouseDeltaX:0,mouseDeltaY:0},this.on()}return _createClass(t,[{key:"styledMembers",value:function(){setStyles(this.$handler,{cursor:"move",userSelect:"none"})}},{key:"on",value:function(){this.styledMembers(),addEvents(window,["resize"],this.onResize),addEvents(this.$handler,["mousedown","touchstart"],this.onMouseDown,passiveOptions),addEvents(document,["mouseup","touchend","touchcancel"],this.onMouseUp,passiveOptions),addEvents(document,["mousemove","touchmove"],this.onMouseMove,passiveOptions)}}]),t}();Movable.version="1.0.0";var _initialiseProps=function(){var t=this;this.onResize=function(){var e=t.$container.getBoundingClientRect(),n=e.x,a=e.y,i=e.width,s=e.height;t.state.innerWidth=window.innerWidth,t.state.innerHeight=window.innerHeight,t.state.originX=n-t.state.deltaX,t.state.originY=a-t.state.deltaY,t.state.width=i,t.state.height=s,t.state.mouseDeltaX=0,t.state.mouseDeltaY=0},this.onMouseDown=function(e){var n=getClientXY(e),a=n.clientX,i=n.clientY;t.state.currentX=a,t.state.currentY=i,t.state.movable=!0},this.onMouseUp=function(){t.state.movable&&(t.state.movable=!1,t.state.deltaX+=t.state.mouseDeltaX,t.state.deltaY+=t.state.mouseDeltaY,t.state.mouseDeltaX=0,t.state.mouseDeltaY=0)},this.onMouseMove=function(e){if(!t.state.movable)return!1;var n=getClientXY(e),a=n.clientX,i=n.clientY,s=a-t.state.currentX,o=i-t.state.currentY;t.state.mouseDeltaX=s,t.state.mouseDeltaY=o;var r=t.state.deltaX+s,l=t.state.deltaY+o;if(t.state.boundable){var u=t.state,d=u.originX,c=u.originY,h=u.width,v=u.height,f=u.innerWidth,m=u.innerHeight;d+r<0?(r=-d,t.boundaried=!0,t.state.mouseDeltaX=-d-t.state.deltaX):f<d+h+r&&(r=f-(d+h),t.boundaried=!0,t.state.mouseDeltaX=f-d-h-t.state.deltaX),c+l<0?(l=-c,t.boundaried=!0,t.state.mouseDeltaY=-c-t.state.deltaY):m<c+v+l&&(l=m-(c+v),t.boundaried=!0,t.state.mouseDeltaY=m-c-v-t.state.deltaY)}setStyles(t.$container,{"-webkit-transform":"translate3d("+r+"px, "+l+"px, 0px)","-moz-transform":"translate3d("+r+"px, "+l+"px, 0px)","-o-transform":"translate3d("+r+"px, "+l+"px, 0px)",transform:"translate3d("+r+"px, "+l+"px, 0px)"})}};export default Movable;
