!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.movable=e()}(this,function(){"use strict";function t(t){return"string"==typeof t?document.querySelector(t):t}function e(t,e,n){var o="number"==typeof n?n+"px":n;if(t.style[e]===o)return!1;t.style[e]=o}function n(t,e){if(!t)throw new Error(e)}var o=function(){return null};function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o,i=arguments[3];e.forEach(function(e){return t.addEventListener(e,n,i)})}var a=["touchstart","touchmove","touchend","touchcancel"];function r(t){if(-1===a.indexOf(t.type))return{clientX:t.clientX,clientY:t.clientY};var e=t.targetTouches[0]||t.touches[0];return{clientX:e.clientX,clientY:e.clientY}}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();var u=!!function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,e)}catch(t){}return t}()&&{passive:!0,capture:!1},l=function(){function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),c.call(this);var i=e.boundable,a=void 0!==i&&i,r=e.fixed,s=void 0!==r&&r,u=e.handler||".handler",l=e.container;this.$handler=t(u),this.$container=l&&t(l)||this.$handler,n(this.$handler,u+" element should be mounted first."),n(this.$container,l+" element should be mounted first.");var d=this.$container.getBoundingClientRect(),h=d.x,f=d.y,m=d.width,v=d.height;this.state={fixed:s,boundable:a,movable:!1,boundaried:!1,originX:h,originY:f,width:m,height:v,innerWidth:window.innerWidth,innerHeight:window.innerHeight,currentX:0,currentY:0,deltaX:0,deltaY:0,mouseDeltaX:0,mouseDeltaY:0},this.on()}return s(o,[{key:"styledMembers",value:function(){e(this.$handler,"cursor","move")}},{key:"on",value:function(){this.styledMembers(),i(window,["resize"],this.onResize),i(this.$handler,["mousedown","touchstart"],this.onMouseDown,u),i(document,["mouseup","touchend","touchcancel"],this.onMouseUp,u),i(document,["mousemove","touchmove"],this.onMouseMove,u)}}]),o}();l.version="0.0.9";var c=function(){var t=this;this.onResize=function(){var e=t.$container.getBoundingClientRect(),n=e.x,o=e.y,i=e.width,a=e.height;console.log("resize"),t.state.innerWidth=window.innerWidth,t.state.innerHeight=window.innerHeight,t.state.originX=n-t.state.deltaX,t.state.originY=o-t.state.deltaY,t.state.width=i,t.state.height=a,t.state.mouseDeltaX=0,t.state.mouseDeltaY=0},this.onMouseDown=function(e){var n=r(e),o=n.clientX,i=n.clientY;t.state.currentX=o,t.state.currentY=i,t.state.movable=!0},this.onMouseUp=function(){t.state.movable&&(t.state.movable=!1,t.state.deltaX+=t.state.mouseDeltaX,t.state.deltaY+=t.state.mouseDeltaY,console.log("reset mouse delta"),t.state.mouseDeltaX=0,t.state.mouseDeltaY=0)},this.onMouseMove=function(n){if(!t.state.movable)return!1;var o=r(n),i=o.clientX,a=o.clientY,s=i-t.state.currentX,u=a-t.state.currentY;t.state.mouseDeltaX=s,t.state.mouseDeltaY=u;var l,c,d=t.state.deltaX+s,h=t.state.deltaY+u;if(t.state.boundable){var f=t.state,m=f.originX,v=f.originY,p=f.width,b=f.height,g=f.innerWidth,w=f.innerHeight;m+d<0?(d=-m,t.boundaried=!0,t.state.mouseDeltaX=-m-t.state.deltaX):g<m+p+d&&(d=g-(m+p),t.boundaried=!0,t.state.mouseDeltaX=g-m-p-t.state.deltaX),v+h<0?(h=-v,t.boundaried=!0,t.state.mouseDeltaY=-v-t.state.deltaY):w<v+b+h&&(h=w-(v+b),t.boundaried=!0,t.state.mouseDeltaY=w-v-b-t.state.deltaY)}l=t.$container,c={"-webkit-transform":"translate3d("+d+"px, "+h+"px, 0px)","-moz-transform":"translate3d("+d+"px, "+h+"px, 0px)","-o-transform":"translate3d("+d+"px, "+h+"px, 0px)",transform:"translate3d("+d+"px, "+h+"px, 0px)"},Object.keys(c).forEach(function(t){e(l,t,c[t])})}};return l});
